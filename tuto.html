<head> <style type="text/css" data-fela-rehydration="444" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-webkit-keyframes k2{0%{transform:matrix(0.97, 0, 0, 1, 0, 12);opacity:0}20%{transform:matrix(0.99, 0, 0, 1, 0, 2);opacity:0.7}40%{transform:matrix(1, 0, 0, 1, 0, -1);opacity:1}70%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}100%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}}@-moz-keyframes k2{0%{transform:matrix(0.97, 0, 0, 1, 0, 12);opacity:0}20%{transform:matrix(0.99, 0, 0, 1, 0, 2);opacity:0.7}40%{transform:matrix(1, 0, 0, 1, 0, -1);opacity:1}70%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}100%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}}@keyframes k2{0%{transform:matrix(0.97, 0, 0, 1, 0, 12);opacity:0}20%{transform:matrix(0.99, 0, 0, 1, 0, 2);opacity:0.7}40%{transform:matrix(1, 0, 0, 1, 0, -1);opacity:1}70%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}100%{transform:matrix(1, 0, 0, 1, 0, 0);opacity:1}}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:fixed}.n{top:0}.o{left:0}.p{right:0}.q{z-index:500}.r{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.v{padding-left:24px}.w{padding-right:24px}.x{margin-left:auto}.y{margin-right:auto}.z{height:65px}.ab{width:100%}.ac{max-width:1080px}.ae{box-sizing:border-box}.af{display:flex}.ag{align-items:center}.aj{flex:1 0 auto}.ak{margin-left:-6px}.al{fill:rgba(0, 0, 0, 0.84)}.am{border-left:1px solid rgba(0, 0, 0, 0.2)}.an{margin-left:10px}.ao{margin-right:14px}.ap{height:24px}.aq{width:1px}.ar{height:36px}.as{width:89px}.at{flex:0 0 auto}.au{margin-left:16px}.av{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.aw{font-style:normal}.ax{line-height:20px}.ay{font-size:15.8px}.az{letter-spacing:0px}.ba{color:rgba(0, 0, 0, 0.54)}.bb{fill:rgba(0, 0, 0, 0.54)}.bc{color:rgba(90, 119, 138, 1)}.bd{fill:rgba(102, 139, 162, 1)}.be{font-size:inherit}.bf{border:inherit}.bg{font-family:inherit}.bh{letter-spacing:inherit}.bi{font-weight:inherit}.bj{padding:0}.bk{margin:0}.bl:hover{cursor:pointer}.bm:hover{color:rgba(83, 109, 125, 1)}.bn:hover{fill:rgba(90, 119, 138, 1)}.bo:focus{outline:none}.bp:disabled{cursor:default}.bq:disabled{color:rgba(3, 168, 124, 0.5)}.br:disabled{fill:rgba(3, 168, 124, 0.5)}.bs{padding:8px 16px}.bt{background:0}.bu{border-color:rgba(102, 139, 162, 1)}.bv:hover{border-color:rgba(90, 119, 138, 1)}.bw{border-radius:4px}.bx{border-width:1px}.by{border-style:solid}.bz{display:inline-block}.ca{text-decoration:none}.cb{border-top:1px solid rgba(0, 0, 0, 0.1)}.cc{display:none}.ce{height:54px}.cf{overflow:hidden}.cg{margin-right:40px}.ch{overflow:auto}.ci{flex:0 1 auto}.cj{list-style-type:none}.ck{line-height:40px}.cl{white-space:nowrap}.cm{overflow-x:auto}.cn{align-items:flex-start}.co{margin-top:20px}.cp{padding-top:20px}.cq{height:80px}.cr{margin-bottom:0px}.cu{max-width:728px}.cv{flex-direction:column}.cw{opacity:0}.cx{pointer-events:none}.cy{will-change:opacity}.cz{width:131px}.da{left:50%}.db{transform:translateX(-516px)}.dc{top:calc(65px + 54px + 40px)}.de{padding-bottom:28px}.df{border-bottom:1px solid rgba(0, 0, 0, 0.1)}.dg{color:inherit}.dh{fill:inherit}.di:hover{color:rgba(0, 0, 0, 0.9)}.dj:hover{fill:rgba(0, 0, 0, 0.9)}.dk:disabled{color:rgba(0, 0, 0, 0.54)}.dl:disabled{fill:rgba(0, 0, 0, 0.54)}.dm{font-weight:600}.dn{font-size:18px}.do{color:rgba(0, 0, 0, 0.84)}.dp{padding-bottom:20px}.dq{padding-top:2px}.dr{font-weight:300}.ds{font-size:16px}.dt{max-height:120px}.du{text-overflow:ellipsis}.dv{display:-webkit-box}.dw{-webkit-line-clamp:6}.dx{-webkit-box-orient:vertical}.dy{padding:4px 12px}.dz{padding-top:28px}.ea{margin-bottom:19px}.eb{margin-left:-5px}.ec{margin-right:5px}.ed{position:relative}.ee{outline:0}.ef{border:0}.eg{user-select:none}.eh{cursor:pointer}.ei> svg{pointer-events:none}.ej:active{border-style:none}.ek{-webkit-user-select:none}.el:focus{fill:rgba(90, 119, 138, 1)}.em{margin-top:5px}.en button{text-align:left}.eo{margin-top:40px}.ep{clear:both}.eq{justify-content:center}.ew{max-width:680px}.ex{flex-wrap:wrap}.ey{margin-top:25px}.ez{margin-right:8px}.fa{margin-bottom:8px}.fb{border-radius:3px}.fc{padding:5px 10px}.fd{background:rgba(0, 0, 0, 0.05)}.fe{line-height:22px}.ff{font-size:15px}.fg{margin-top:15px}.fh{justify-content:space-between}.fi{margin-right:16px}.fj{border:1px solid rgba(0, 0, 0, 0.1)}.fk{border-radius:50%}.fl{height:60px}.fm{width:60px}.fz:active{border-style:solid}.ga{background:rgba(255, 255, 255, 1)}.gb{z-index:2}.gc{height:100%}.gd{position:absolute}.gf{padding-right:8px}.gg{padding-top:32px}.gh{margin-bottom:25px}.gi{margin-bottom:32px}.gj{min-height:80px}.go{width:80px}.gp{padding-left:102px}.gr{text-transform:uppercase}.gs{letter-spacing:0.05em}.gt{margin-bottom:6px}.gu{font-size:28px}.gv{line-height:36px}.gw{max-width:555px}.gx{max-width:450px}.gy{line-height:24px}.ha{max-width:550px}.hb{padding-top:25px}.hc{padding:20px}.hd{border:1px solid rgba(102, 139, 162, 1)}.he{text-align:center}.hf{margin-top:64px}.hg{background-color:rgba(0, 0, 0, 0.02)}.hh{max-width:1032px}.hi{padding:60px 0}.hj{background-color:rgba(0, 0, 0, 0.9)}.ia{padding-bottom:48px}.ib{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.ic{margin:0 -12px}.id{margin:0 12px}.ie{flex:1 1 0}.if{padding-bottom:12px}.ig:hover{color:rgba(255, 255, 255, 0.99)}.ih:hover{fill:rgba(255, 255, 255, 0.99)}.ii:disabled{color:rgba(255, 255, 255, 0.7)}.ij:disabled{fill:rgba(255, 255, 255, 0.7)}.ik{color:rgba(255, 255, 255, 0.98)}.il{fill:rgba(255, 255, 255, 0.98)}.im{text-align:inherit}.in{font-size:21.6px}.io{letter-spacing:-0.32px}.ip{color:rgba(255, 255, 255, 0.7)}.iq{fill:rgba(255, 255, 255, 0.7)}.ir{text-decoration:underline}.is{padding-bottom:8px}.it{padding-top:8px}.iu{width:200px}.iw:hover{text-decoration:underline}.ix{top:calc(100vh + 100px)}.iy{bottom:calc(100vh + 100px)}.iz{width:10px}.ja{word-break:break-word}.jb{word-wrap:break-word}.jc:after{display:block}.jd:after{content:""}.je:after{clear:both}.jf{margin:0 auto}.jg{line-height:1.23}.jh{letter-spacing:0}.ji{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.jj{font-size:40px}.jp{margin-bottom:-0.27em}.jq{line-height:48px}.jr{line-height:1.394}.js{font-size:25px}.jy{margin-bottom:-0.42em}.jz{font-size:24px}.ka{line-height:32px}.kb{margin-top:32px}.kc{height:48px}.kd{width:48px}.ke{margin-left:12px}.kf{margin-bottom:2px}.kh{max-height:20px}.ki{-webkit-line-clamp:1}.kj{margin-left:8px}.kk{padding:0px 8px}.kl{border-color:rgba(0, 0, 0, 0.54)}.km:hover{color:rgba(0, 0, 0, 0.97)}.kn:hover{fill:rgba(0, 0, 0, 0.97)}.ko:hover{border-color:rgba(0, 0, 0, 0.84)}.kp:disabled{fill:rgba(0, 0, 0, 0.76)}.kq:disabled{border-color:rgba(0, 0, 0, 0.2)}.kr:disabled{cursor:inherit}.ks:disabled:hover{color:rgba(0, 0, 0, 0.54)}.kt:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.ku:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.kv{line-height:18px}.kw{line-height:1.58}.kx{letter-spacing:-0.004em}.ky{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.lj{margin-bottom:-0.46em}.lk{background-repeat:repeat-x}.ll{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.lm{background-size:1px 1px}.ln{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.lo{box-shadow:inset 3px 0 0 0 rgba(0, 0, 0, 0.84)}.lp{padding-left:23px}.lq{margin-left:-20px}.lr{font-style:italic}.ls{font-weight:700}.lt{line-height:1.12}.lu{letter-spacing:-0.022em}.mf{margin-bottom:-0.28em}.ml{max-width:996px}.mr{border-width:2px}.ms{border-color:rgba(255, 255, 255, 1)}.mt{float:left}.mu{margin-left:-150px}.mv{margin-right:30px}.mw{width:75%}.mx{padding-bottom:10px}.nc{margin-bottom:16px}.nd{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ne{cursor:zoom-in}.nf{z-index:auto}.ng{transition:opacity 100ms 400ms}.nh{will-change:transform}.ni{transform:translateZ(0)}.nj{margin:auto}.nk{background-color:rgba(0, 0, 0, 0.05)}.nl{padding-bottom:75.1004016064257%}.nm{filter:blur(20px)}.nn{transform:scale(1.1)}.no{visibility:visible}.np{list-style-type:disc}.nq{margin-left:30px}.nr{padding-left:0px}.nx{max-width:1285px}.ny{padding-bottom:45.05836575875486%}.nz{line-height:1.4}.oa{margin-top:10px}.od{max-width:309px}.oe{padding-bottom:87.37864077669903%}.of{line-height:1.18}.oq{margin-bottom:-0.31em}.or{max-width:452px}.os{padding-bottom:39.15929203539823%}.ot{max-width:593px}.ou{padding-bottom:97.47048903878583%}.ov{max-width:407px}.ow{padding-bottom:81.81818181818181%}.ox{list-style-type:decimal}.oy{max-width:933px}.oz{padding-bottom:38.263665594855304%}.pa{max-width:645px}.pb{padding-bottom:33.64341085271318%}.pc{max-width:455px}.pd{padding-bottom:44.17582417582418%}.pe{max-width:460px}.pf{padding-bottom:96.52173913043478%}.pg{max-width:871px}.ph{padding-bottom:77.26750861079219%}.pi{max-width:948px}.pj{padding-bottom:69.72573839662446%}.pk{padding:2px 4px}.pl{font-size:75%}.pm{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.pn{margin-top:-0.09em}.po{margin-bottom:-0.09em}.pp{white-space:pre-wrap}.pv{max-width:831px}.pw{padding-bottom:70.15643802647412%}.px{max-width:812px}.py{padding-bottom:42.733990147783246%}.pz{max-width:942px}.qa{padding-bottom:52.44161358811041%}.qb{max-width:937px}.qc{padding-bottom:66.27534685165422%}.qd{-webkit-user-select:none}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ev{margin:0 24px}.hx{padding-left:24px}.hy{padding-right:24px}.hz{max-width:1080px}.jo{margin-top:0.78em}.jx{margin-top:0.74em}.lh{font-size:21px}.li{margin-top:2em}.md{font-size:34px}.me{margin-top:1.95em}.mk{margin-top:0.86em}.mq{margin-top:56px}.nw{margin-top:1.05em}.oo{font-size:26px}.op{margin-top:1.72em}.pu{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.hu{padding-left:24px}.hv{padding-right:24px}.hw{max-width:1080px}.ob{margin-left:auto}.oc{text-align:center}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.hr{padding-left:24px}.hs{padding-right:24px}.ht{max-width:904px}.my{float:none}.mz{margin-left:0}.na{margin-right:0}.nb{width:100%}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ah{height:56px}.ai{display:flex}.cd{display:block}.cs{margin-bottom:0px}.ct{height:110px}.gk{margin-bottom:24px}.gl{align-items:center}.gm{width:102px}.gn{position:relative}.gq{padding-left:0}.gz{margin-top:24px}.hk{padding:32px 0}.ho{padding-left:24px}.hp{padding-right:24px}.hq{max-width:728px}.iv{width:140px}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.er{margin:0 24px}.hl{padding-left:24px}.hm{padding-right:24px}.hn{max-width:552px}.jk{margin-top:0.39em}.jt{margin-top:0.42em}.kg{margin-bottom:0px}.kz{font-size:18px}.la{margin-top:1.56em}.lv{font-size:30px}.lw{margin-top:1.2em}.mg{margin-top:0.67em}.mm{margin-top:40px}.ns{margin-top:1.34em}.og{font-size:24px}.oh{margin-top:1.23em}.pq{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.eu{margin:0 24px}.jn{margin-top:0.78em}.jw{margin-top:0.74em}.lf{font-size:21px}.lg{margin-top:2em}.mb{font-size:34px}.mc{margin-top:1.95em}.mj{margin-top:0.86em}.mp{margin-top:56px}.nv{margin-top:1.05em}.om{font-size:26px}.on{margin-top:1.72em}.pt{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.et{margin:0 24px}.jm{margin-top:0.78em}.jv{margin-top:0.74em}.ld{font-size:21px}.le{margin-top:2em}.lz{font-size:34px}.ma{margin-top:1.95em}.mi{margin-top:0.86em}.mo{margin-top:56px}.nu{margin-top:1.05em}.ok{font-size:26px}.ol{margin-top:1.72em}.ps{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.es{margin:0 24px}.jl{margin-top:0.39em}.ju{margin-top:0.42em}.lb{font-size:18px}.lc{margin-top:1.56em}.lx{font-size:30px}.ly{margin-top:1.2em}.mh{margin-top:0.67em}.mn{margin-top:40px}.nt{margin-top:1.34em}.oi{font-size:24px}.oj{margin-top:1.23em}.pr{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="print">.u{display:none}</style><style type="text/css" data-fela-rehydration="444" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.s{transition:transform 300ms ease}.t{will-change:transform}.dd{transition:opacity 200ms}.fn{transition:border-color 150ms ease}.fo::before{background:
      radial-gradient(circle, rgba(90, 119, 138, 1) 60%, transparent 70%)
    }.fp::before{border-radius:50%}.fq::before{content:""}.fr::before{display:block}.fs::before{z-index:0}.ft::before{left:0}.fu::before{height:100%}.fv::before{position:absolute}.fw::before{top:0}.fx::before{width:100%}.fy:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.ge{transition:fill 200ms ease}</style><script charset="utf-8" src="https://cdn-client.medium.com/lite/static/js/vendors~tracing.9f9c73c5.chunk.js"></script><script charset="utf-8" src="https://cdn-client.medium.com/lite/static/js/tracing.8c63ed59.chunk.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*w_ownWZZ38QhiVjVU757DA.png"],"url":"https:\u002F\u002Fengineering.matterport.com\u002Fsplash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46","dateCreated":"2018-03-20T00:23:01.092Z","datePublished":"2018-03-20T00:23:01.092Z","dateModified":"2018-12-10T01:53:20.068Z","headline":"Splash of Color: Instance Segmentation with Mask R-CNN and TensorFlow","name":"Splash of Color: Instance Segmentation with Mask R-CNN and TensorFlow","description":"Back in November, we open-sourced our implementation of Mask R-CNN, and since then it’s been forked 1400 times, used in a lot of projects, and improved upon by many generous contributors. We…","identifier":"7c761e238b46","keywords":["Lite:true","Tag:Mask Rcnn","Tag:Object Detection","Tag:Instance Segmentation","Tag:Computer Vision","Tag:Deep Learning","Publication:matterport-engineering","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"Waleed Abdulla","url":"https:\u002F\u002Fengineering.matterport.com\u002F@waleedka"},"creator":["Waleed Abdulla"],"publisher":{"@type":"Organization","name":"Matterport Engineering Techblog","url":"engineering.matterport.com","logo":{"@type":"ImageObject","width":147,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F147\u002F1*g2BYfefpbBmRV26SMbaUxQ.png"}},"mainEntityOfPage":"https:\u002F\u002Fengineering.matterport.com\u002Fsplash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46"}</script><link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css"></head>






<body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="l m n o p c q r s t u"><div class="branch-journeys-top"><div class="l c"> </div><div class="cb cc c cd"><section class="v w x y ce ab ac ae cf af ag"><div class="cg l at"><a href="https://engineering.matterport.com/?source=post_page-----7c761e238b46----------------------"><div class="ar as l"><img alt="Matterport Engineering Techblog" class="" src="https://miro.medium.com/max/178/1*g2BYfefpbBmRV26SMbaUxQ.png" width="89" height="36"></div></a></div><div class="ch l ci"><ul class="cj bk ck cl cm af cn g co cp cq"></ul></div></section></div></div></nav><div class="cr z l cs ct"></div><article><section class="v w x y ab cu ae af cv"></section><span class="l"></span><div><div class="gd o ix iy iz cx"></div><div class="x y cu ed"><div class="l h g f e"><aside class="qi gd n" style="width: 919px;"><div class="ql qm gd qn cl ab"><h4 class="av dr ff ax ba"><span class="bz qm cl cf du">Top highlight</span></h4></div></aside></div></div><section class="ja jb jc jd je"><div class="ae jf ab cu v w"><div><div id="f392" class="jg jh do aw ji b jj jk jl jm jn jo jp"><h1 class="ji b jj jq do">Splash of Color: Instance Segmentation with Mask R-CNN and TensorFlow</h1></div></div><div id="fcd0" class="jr jh ba aw av dr js jt ju jv jw jx jy"><h2 class="av dr jz ka ba">Explained by building a color splash filter</h2></div><div class="kb"><div class="ag af"><div><a href="/@waleedka?source=post_page-----7c761e238b46----------------------"> </a></div><div class="ke ab l"><div class="af"><div style="flex:1"><span class="av b aw ax ay az l do al"><div class="kf af ag kg"><span class="av dr ds ax cf kh du dv ki dx do"><a href="/@waleedka?source=post_page-----7c761e238b46----------------------" class="dg dh be bf bg bh bi bj bk bl iw bo bp dk dl">Waleed Abdulla</a></span><div class="kj l at h">
   
</div></div></span></div></div><span class="av b aw ax ay az l ba bb"><span class="av dr ds ax cf kh du dv ki dx ba"><div><a class="dg dh be bf bg bh bi bj bk bl iw bo bp dk dl" href="/splash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46?source=post_page-----7c761e238b46----------------------">Mar 20, 2018</a> <!-- -->·<!-- --> <!-- -->12<!-- --> min read</div></span></span></div></div></div><p id="04b2" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Back in November, we open-sourced our <a href="https://github.com/matterport/Mask_RCNN" class="dg ca lk ll lm ln" target="_blank">implementation of Mask R-CNN</a>, and since then it’s been forked 1400 times, used in a lot of projects, and improved upon by many generous contributors. We received a lot of questions as well, so in this post I’ll explain how the model works and show how to use it in a real application.</p><p id="64b6" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">I’ll cover two things: First, an overview of Mask RCNN. And, second, how to train a model from scratch and use it to build a smart color splash filter.</p><blockquote class="lo lp lq"><p id="3f65" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>We’re sharing the code <a href="https://github.com/matterport/Mask_RCNN/tree/master/samples/balloon" class="dg ca lk ll lm ln" target="_blank">here</a>. Including the dataset I built and the trained model. Follow along!</p></blockquote><h1 id="1d4c" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">What is Instance Segmentation?</h1><p id="4e7c" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">Instance segmentation is the task of identifying object outlines at the pixel level. Compared to similar computer vision tasks, it’s one of the hardest possible vision tasks. Consider the following asks:</p><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="nd ne ed nf ab"><div class="x y ml"><div class="nj l ed nk"><div class="nl l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*-zw_Mh1e-8YncnokbAFWxg.png?q=20" width="996" height="748" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="996" height="748" role="presentation" src="https://miro.medium.com/max/996/1*-zw_Mh1e-8YncnokbAFWxg.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1992/1*-zw_Mh1e-8YncnokbAFWxg.png" width="996" height="748" role="presentation"/></noscript></div></div></div></div></figure><ul class=""><li id="beac" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Classification: </strong>There is a balloon in this image.</li><li id="cec8" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Semantic Segmentation:</strong> These are all the balloon pixels.</li><li id="db7f" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Object Detection: </strong>There are 7 balloons in this image at these locations. We’re starting to account for objects that overlap.</li><li id="a421" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Instance Segmentation</strong>: There are 7 balloons at these locations, and these are the pixels that belong to each one.</li></ul><h1 id="fb1b" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Mask R-CNN</h1><p id="4745" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">Mask R-CNN (regional convolutional neural network) is a two stage framework: the first stage scans the image and generates <em class="lr">proposals</em>(areas likely to contain an object). And the second stage classifies the proposals and generates bounding boxes and masks.</p><p id="7305" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">It was introduced last year via the <a href="https://arxiv.org/abs/1703.06870" class="dg ca lk ll lm ln" target="_blank">Mask R-CNN paper</a> to extend its predecessor, <a href="https://arxiv.org/abs/1506.01497" class="dg ca lk ll lm ln" target="_blank">Faster R-CNN</a>, by the same authors. Faster R-CNN is a popular framework for object detection, and Mask R-CNN extends it with instance segmentation, among other things.</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y nx"><div class="nj l ed nk"><div class="ny l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*IWWOPIYLqqF9i_gXPmBk3g.png?q=20" width="1285" height="579" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="1285" height="579" role="presentation" src="https://miro.medium.com/max/1285/1*IWWOPIYLqqF9i_gXPmBk3g.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/2570/1*IWWOPIYLqqF9i_gXPmBk3g.png" width="1285" height="579" role="presentation"/></noscript></div></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Mask R-CNN framework. Source: <a href="https://arxiv.org/abs/1703.06870" class="dg ca lk ll lm ln" target="_blank">https://arxiv.org/abs/1703.06870</a></figcaption></figure><p id="9820" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">At a high level, Mask R-CNN consists of these modules:</p><h1 id="5d32" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">1. Backbone</h1><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="x y od"><div class="nj l ed nk"><div class="oe l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*IDjLXsSw5QMFWDudayIBfw.png?q=20" width="309" height="270" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="309" height="270" role="presentation" src="https://miro.medium.com/max/309/1*IDjLXsSw5QMFWDudayIBfw.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/618/1*IDjLXsSw5QMFWDudayIBfw.png" width="309" height="270" role="presentation"/></noscript></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Simplified illustration of the backbone nework</figcaption></figure><p id="b9da" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">This is a standard convolutional neural network (typically, ResNet50 or ResNet101) that serves as a feature extractor. The early layers detect low level features (edges and corners), and later layers successively detect higher level features (car, person, sky).</p><p id="5ab7" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Passing through the backbone network, the image is converted from 1024x1024px x 3 (RGB) to a feature map of shape 32x32x2048. This feature map becomes the input for the following stages.</p><blockquote class="lo lp lq"><p id="b6fc" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>The backbone is built in the function <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L171" class="dg ca lk ll lm ln" target="_blank">resnet_graph()</a>. The code supports ResNet50 and ResNet101.</p></blockquote><h2 id="62a8" class="of lu do aw av dm og oh oi oj ok ol om on oo op oq" data-selectable-paragraph="">Feature Pyramid Network</h2><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="x y or"><div class="nj l ed nk"><div class="os l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*1sCveJrqfthOQsGGZRs2tQ.png?q=20" width="452" height="177" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="452" height="177" role="presentation" src="https://miro.medium.com/max/452/1*1sCveJrqfthOQsGGZRs2tQ.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/904/1*1sCveJrqfthOQsGGZRs2tQ.png" width="452" height="177" role="presentation"/></noscript></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Source: Feature Pyramid Networks paper</figcaption></figure><p id="3947" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">While the backbone described above works great, it can be improved upon. The <a href="https://arxiv.org/abs/1612.03144" class="dg ca lk ll lm ln" target="_blank">Feature Pyramid Network (FPN)</a> was introduced by the same authors of Mask R-CNN as an extension that can better represent objects at multiple scales.</p><p id="4b58" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">FPN improves the standard feature extraction pyramid by adding a second pyramid that takes the high level features from the first pyramid and passes them down to lower layers. By doing so, it allows features at every level to have access to both, lower and higher level features.</p><p id="2946" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Our implementation of Mask RCNN uses a ResNet101 + FPN backbone.</p><blockquote class="lo lp lq"><p id="2994" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br> The FPN is created in <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L1840" class="dg ca lk ll lm ln" target="_blank">MaskRCNN.build()</a>. The section after building the ResNet. <br>RPN introduces additional complexity: rather than a single backbone feature map in the standard backbone (i.e. the top layer of the first pyramid), in FPN there is a feature map at each level of the second pyramid. We pick which to use dynamically depending on the size of the object. I’ll continue to refer to the <strong class="ky ls">backbone feature map</strong> as if it’s one feature map, but keep in mind that when using FPN, we’re actually picking one out of several at runtime.</p></blockquote><h1 id="1cdb" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">2. Region Proposal Network (RPN)</h1><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="nd ne ed nf ab"><div class="x y ot"><div class="nj l ed nk"><div class="ou l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*ESpJx0XLvyBa86TNo2BfLQ.png?q=20" width="593" height="578" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="593" height="578" role="presentation" src="https://miro.medium.com/max/593/1*ESpJx0XLvyBa86TNo2BfLQ.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1186/1*ESpJx0XLvyBa86TNo2BfLQ.png" width="593" height="578" role="presentation"/></noscript></div></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Simplified illustration showing 49 anchor boxes</figcaption></figure><p id="465d" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The RPN is a lightweight neural network that scans the image in a sliding-window fashion and finds areas that contain objects.</p><p id="ab7f" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The regions that the RPN scans over are called <em class="lr">anchors</em>. Which are boxes distributed over the image area, as show on the left. This is a simplified view, though. In practice, there are about 200K anchors of different sizes and aspect ratios, and they overlap to cover as much of the image as possible.</p><p id="8557" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">How fast can the RPN scan that many anchors? Pretty fast, actually. The sliding window is handled by the convolutional nature of the RPN, which allows it to scan all regions in parallel (on a GPU). Further, the RPN doesn’t scan over the image directly (even though we draw the anchors on the image for illustration). <mark class="qj qk eh">Instead, the RPN scans over the backbone feature map.</mark> This allows the RPN to reuse the extracted features efficiently and avoid duplicate calculations. With these optimizations, the RPN runs in about 10 ms according to the <a href="https://arxiv.org/abs/1506.01497" class="dg ca lk ll lm ln" target="_blank">Faster RCNN paper</a> that introduced it. In Mask RCNN we typically use larger images and more anchors, so it might take a bit longer.</p><blockquote class="lo lp lq"><p id="dbe2" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:<br></strong>The RPN is created in <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L831" class="dg ca lk ll lm ln" target="_blank">rpn_graph()</a>. Anchor scales and aspect ratios are controlled by RPN_ANCHOR_SCALES and RPN_ANCHOR_RATIOS in <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/config.py" class="dg ca lk ll lm ln" target="_blank">config.py</a>.</p></blockquote><p id="384b" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The RPN generates two outputs for each anchor:</p><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="x y ov"><div class="nj l ed nk"><div class="ow l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*EMNE8bxOT4RI3HMjIqjCwQ.png?q=20" width="407" height="333" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="407" height="333" role="presentation" src="https://miro.medium.com/max/407/1*EMNE8bxOT4RI3HMjIqjCwQ.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/814/1*EMNE8bxOT4RI3HMjIqjCwQ.png" width="407" height="333" role="presentation"/></noscript></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">3 anchor boxes (dotted) and the shift/scale applied to them to fit the object precisely (solid). Several anchors can map to the same object.</figcaption></figure><ol class=""><li id="e802" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj ox nq nr" data-selectable-paragraph=""><strong class="ky ls">Anchor Class:</strong> One of two classes: foreground or background. The FG class implies that there is likely an object in that box.</li><li id="6e7e" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj ox nq nr" data-selectable-paragraph=""><strong class="ky ls">Bounding Box Refinement:</strong> A foreground anchor (also called positive anchor) might not be centered perfectly over the object. So the RPN estimates a delta (% change in x, y, width, height) to refine the anchor box to fit the object better.</li></ol><p id="bb7a" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Using the RPN predictions, we pick the top anchors that are likely to contain objects and refine their location and size. If several anchors overlap too much, we keep the one with the highest foreground score and discard the rest (referred to as Non-max Suppression). After that we have the final <em class="lr">proposals </em>(regions of interest)<em class="lr"> </em>that we pass to the next stage.</p><blockquote class="lo lp lq"><p id="4b8c" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>The <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L255" class="dg ca lk ll lm ln" target="_blank">ProposalLayer</a> is a custom Keras layer that reads the output of the RPN, picks top anchors, and applies bounding box refinement.</p></blockquote><h1 id="1c01" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">3. ROI Classifier &amp; Bounding Box Regressor</h1><p id="cdfb" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">This stage runs on the regions of interest (ROIs) proposed by the RPN. And just like the RPN, it generates two outputs for each ROI:</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y oy"><div class="nj l ed nk"><div class="oz l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*xQYuM_9mu5kt8nNN8Ms2TQ.png?q=20" width="933" height="357" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="933" height="357" role="presentation" src="https://miro.medium.com/max/933/1*xQYuM_9mu5kt8nNN8Ms2TQ.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1866/1*xQYuM_9mu5kt8nNN8Ms2TQ.png" width="933" height="357" role="presentation"/></noscript></div></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Illustration of stage 2. Source: Fast R-CNN (<a href="https://arxiv.org/abs/1504.08083" class="dg ca lk ll lm ln" target="_blank">https://arxiv.org/abs/1504.08083</a>)</figcaption></figure><ol class=""><li id="64f4" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj ox nq nr" data-selectable-paragraph=""><strong class="ky ls">Class:</strong> The class of the object in the ROI. Unlike the RPN, which has two classes (FG/BG), this network is deeper and has the capacity to classify regions to specific classes (person, car, chair, …etc.). It can also generate a <em class="lr">background</em> class, which causes the ROI to be discarded.</li><li id="77b5" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj ox nq nr" data-selectable-paragraph=""><strong class="ky ls">Bounding Box Refinement:</strong> Very similar to how it’s done in the RPN, and its purpose is to further refine the location and size of the bounding box to encapsulate the object.</li></ol><blockquote class="lo lp lq"><p id="a79e" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>The classifier and bounding box regressor are created in <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L901" class="dg ca lk ll lm ln" target="_blank">fpn_classifier_graph()</a>.</p></blockquote><h2 id="6611" class="of lu do aw av dm og oh oi oj ok ol om on oo op oq" data-selectable-paragraph="">ROI Pooling</h2><p id="01b2" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">There is a bit of a problem to solve before we continue. Classifiers don’t handle variable input size very well. They typically require a fixed input size. But, due to the bounding box refinement step in the RPN, the ROI boxes can have different sizes. That’s where ROI Pooling comes into play.</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="x y pa"><div class="nj l ed nk"><div class="pb l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*bsT00ickNk7vaRJNrTvKPQ.png?q=20" width="645" height="217" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="645" height="217" role="presentation" src="https://miro.medium.com/max/645/1*bsT00ickNk7vaRJNrTvKPQ.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1290/1*bsT00ickNk7vaRJNrTvKPQ.png" width="645" height="217" role="presentation"/></noscript></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">The feature map here is from a low-level layer, for illustration, to make it easier to understand.</figcaption></figure><p id="cb1d" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">ROI pooling refers to cropping a part of a feature map and resizing it to a fixed size. It’s similar in principle to cropping part of an image and then resizing it (but there are differences in implementation details).</p><p id="3ba3" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The authors of Mask R-CNN suggest a method they named ROIAlign, in which they sample the feature map at different points and apply a bilinear interpolation. In our implementation, we used TensorFlow’s <a href="https://www.tensorflow.org/api_docs/python/tf/image/crop_and_resize" class="dg ca lk ll lm ln" target="_blank">crop_and_resize</a> function for simplicity and because it’s close enough for most purposes.</p><blockquote class="lo lp lq"><p id="5e88" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>ROI pooling is implemented in the class <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L344" class="dg ca lk ll lm ln" target="_blank">PyramidROIAlign</a>.</p></blockquote><h1 id="814c" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">4. Segmentation Masks</h1><p id="0414" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">If you stop at the end of the last section then you have a <a href="https://arxiv.org/abs/1506.01497" class="dg ca lk ll lm ln" target="_blank">Faster R-CNN</a> framework for object detection. The mask network is the addition that the Mask R-CNN paper introduced.</p><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="x y pc"><div class="nj l ed nk"><div class="pd l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*l55WzUq1ZD2b5EGwW05LDA.png?q=20" width="455" height="201" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="455" height="201" role="presentation" src="https://miro.medium.com/max/455/1*l55WzUq1ZD2b5EGwW05LDA.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/910/1*l55WzUq1ZD2b5EGwW05LDA.png" width="455" height="201" role="presentation"/></noscript></div></div></div></figure><p id="46db" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The mask branch is a convolutional network that takes the positive regions selected by the ROI classifier and generates masks for them. The generated masks are low resolution: 28x28 pixels. But they are <em class="lr">soft</em> masks, represented by float numbers, so they hold more details than binary masks. The small mask size helps keep the mask branch light. During training, we scale down the ground-truth masks to 28x28 to compute the loss, and during inferencing we scale up the predicted masks to the size of the ROI bounding box and that gives us the final masks, one per object.</p><blockquote class="lo lp lq"><p id="63ed" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>The mask branch is in <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/model.py#L957" class="dg ca lk ll lm ln" target="_blank">build_fpn_mask_graph()</a>.</p></blockquote><h1 id="4f9e" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Let’s Build a Color Splash Filter</h1><figure class="mm mn mo mp mq ep ga mr by ms mt mu mv mw bj mx my mz na nb nc paragraph-image"><div class="x y pe"><div class="nj l ed nk"><div class="pf l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/freeze/max/60/1*lAP6vX1tLQaxFn6XGEQ32g.gif?q=20" width="460" height="444" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="460" height="444" role="presentation" src="https://miro.medium.com/max/460/1*lAP6vX1tLQaxFn6XGEQ32g.gif"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/920/1*lAP6vX1tLQaxFn6XGEQ32g.gif" width="460" height="444" role="presentation"/></noscript></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Sample generated by this project</figcaption></figure><p id="e4db" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Unlike most image editing apps that include this filter, our filter will be a bit smarter: It finds the objects automatically. Which becomes even more useful if you want to apply it to videos rather than a single image.</p><h1 id="89d9" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Training Dataset</h1><p id="7371" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">Typically, I’d start by searching for public datasets that contain the objects I need. But in this case, I wanted to document the full cycle and show how to build a dataset from scratch.</p><p id="dfe0" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">I searched for balloon images on flickr, limiting the license type to “Commercial use &amp; mods allowed”. This returned more than enough images for my needs. I picked a total of 75 images and divided them into a training set and a validation set. Finding images is easy. Annotating them is the hard part.</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y pg"><div class="nj l ed nk"><div class="ph l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*Q4tCdhwrklvJLM9zn5aDhg.png?q=20" width="871" height="673" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="871" height="673" role="presentation" src="https://miro.medium.com/max/871/1*Q4tCdhwrklvJLM9zn5aDhg.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1742/1*Q4tCdhwrklvJLM9zn5aDhg.png" width="871" height="673" role="presentation"/></noscript></div></div></div></div></figure><p id="2c9d" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Wait! Don’t we need, like, a million images to train a deep learning model? Sometimes you do, but often you don’t. I’m relying on two main points to reduce my training requirements significantly:</p><p id="879c" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">First, <em class="lr">transfer learning. </em>Which simply means that, instead of training a model from scratch, I start with a weights file that’s been trained on the COCO dataset (we provide that in the github repo). Although the COCO dataset does <strong class="ky ls">not</strong> contain a balloon class, it contains a lot of other images (~120K), so the trained weights have already learned a lot of the features common in natural images, which really helps. And, second, given the simple use case here, I’m not demanding high accuracy from this model, so the tiny dataset should suffice.</p><p id="416f" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">There are a lot of tools to annotate images. I ended up using <a href="http://www.robots.ox.ac.uk/~vgg/software/via/" class="dg ca lk ll lm ln" target="_blank">VIA (VGG Image Annotator)</a> because of its simplicity. It’s a single HTML file that you download and open in a browser. Annotating the first few images was very slow, but once I got used to the user interface, I was annotating at around an object a minute.</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y pi"><div class="nj l ed nk"><div class="pj l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*6SICkQA-YCLp88A7GFM4Ag.png?q=20" width="948" height="661" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="948" height="661" role="presentation" src="https://miro.medium.com/max/948/1*6SICkQA-YCLp88A7GFM4Ag.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1896/1*6SICkQA-YCLp88A7GFM4Ag.png" width="948" height="661" role="presentation"/></noscript></div></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">UI of the VGG Image Annotator tool</figcaption></figure><p id="a07c" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">If you don’t like the VIA tool, here is a list of the other tools I tested:</p><ul class=""><li id="4e5e" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj np nq nr" data-selectable-paragraph=""><a href="http://labelme2.csail.mit.edu/" class="dg ca lk ll lm ln" target="_blank">LabelMe</a>: One of the most known tools. The UI was a bit too slow, though, especially when zooming in on large images.</li><li id="f464" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><a href="https://rectlabel.com/" class="dg ca lk ll lm ln" target="_blank">RectLabel</a>: Simple and easy to work with. Mac only.</li><li id="7ae8" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><a href="https://www.labelbox.io/" class="dg ca lk ll lm ln" target="_blank">LabelBox</a>: Pretty good for larger labeling projects and has options for different types of labeling tasks.</li><li id="2e31" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><a href="http://www.robots.ox.ac.uk/~vgg/software/via/" class="dg ca lk ll lm ln" target="_blank">VGG Image Annotator (VIA)</a>: Fast, light, and really well designed. This is the one I ended up using.</li><li id="8ca5" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><a href="https://github.com/tylin/coco-ui" class="dg ca lk ll lm ln" target="_blank">COCO UI</a>: The tool used to annotate the COCO dataset.</li></ul><h1 id="d280" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Loading the Dataset</h1><p id="a153" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">There isn’t a universally accepted format to store segmentation masks. Some datasets save them as PNG images, others store them as polygon points, and so on. To handle all these cases, our implementation provides a Dataset class that you inherit from and then override a few functions to read your data in whichever format it happens to be.</p><p id="b712" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The VIA tool saves the annotations in a JSON file, and each mask is a set of polygon points. I didn’t find documentation for the format, but it’s pretty easy to figure out by looking at the generated JSON. I included comments in the code to explain how the parsing is done.</p><blockquote class="lo lp lq"><p id="e128" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>An easy way to write code for a new dataset is to copy <a href="https://github.com/matterport/Mask_RCNN/blob/master/samples/coco/coco.py" class="dg ca lk ll lm ln" target="_blank">coco.py</a> and modify it to your needs. Which is what I did. I saved the new file as <a href="https://github.com/matterport/Mask_RCNN/blob/v2.1/samples/balloon/balloon.py" class="dg ca lk ll lm ln" target="_blank">balloons.py</a></p></blockquote><p id="2869" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">My <code class="nk pk pl pm b">BalloonDataset</code> class looks like this:</p><pre class="mm mn mo mp mq hc fd cm"><span id="71f6" class="of lu do aw pm b ds pn po l pp" data-selectable-paragraph="">class <strong class="pm ls">BalloonDataset</strong>(utils.Dataset):</span><span id="1d9c" class="of lu do aw pm b ds pq pr ps pt pu po l pp" data-selectable-paragraph="">    def <strong class="pm ls">load_balloons</strong>(self, dataset_dir, subset):<br>        ...</span><span id="5c60" class="of lu do aw pm b ds pq pr ps pt pu po l pp" data-selectable-paragraph="">    def <strong class="pm ls">load_mask</strong>(self, image_id):<br>        ...</span><span id="a411" class="of lu do aw pm b ds pq pr ps pt pu po l pp" data-selectable-paragraph="">    def <strong class="pm ls">image_reference</strong>(self, image_id):<br>        ...</span></pre><p id="2f1b" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><code class="nk pk pl pm b">load_balloons</code> reads the JSON file, extracts the annotations, and iteratively calls the internal <code class="nk pk pl pm b">add_class</code> and <code class="nk pk pl pm b">add_image</code> functions to build the dataset.</p><blockquote class="lo lp lq"><p id="fd34" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><code class="nk pk pl pm b">load_mask</code> generates bitmap masks for every object in the image by drawing the polygons.</p></blockquote><p id="7af2" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><code class="nk pk pl pm b">image_reference</code> simply returns a string that identifies the image for debugging purposes. Here it simply returns the path of the image file.</p><p id="0866" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">You might have noticed that my class doesn’t contain functions to load images or return bounding boxes. The default <code class="nk pk pl pm b">load_image</code> function in the base <code class="nk pk pl pm b">Dataset</code> class handles loading images. And, bounding boxes are generated dynamically from the masks.</p><blockquote class="lo lp lq"><p id="dfeb" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>Your dataset might not be in JSON. My BalloonDataset class reads JSON because that’s what the VIA tool generates. Don’t convert your dataset to a format similar to COCO or the VIA format. Insetad, write your own Dataset class to load whichever format your dataset comes in. See the <a href="https://github.com/matterport/Mask_RCNN/tree/master/samples" class="dg ca lk ll lm ln" target="_blank">samples</a> and notice how each uses its own Dataset class.</p></blockquote><h2 id="58a4" class="of lu do aw av dm og oh oi oj ok ol om on oo op oq" data-selectable-paragraph="">Verify the Dataset</h2><p id="05e7" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">To verify that my new code is implemented correctly I added this <a href="https://github.com/matterport/Mask_RCNN/blob/v2.1/samples/balloon/inspect_balloon_data.ipynb" class="dg ca lk ll lm ln" target="_blank">Jupyter notebook</a>. It loads the dataset, visualizes masks and bounding boxes, and visualizes the anchors to verify that my anchor sizes are a good fit for my object sizes. Here is an example of what you should expect to see:</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y pv"><div class="nj l ed nk"><div class="pw l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*OKE6wyZFfh2f_aZ3rd9BRw.png?q=20" width="831" height="583" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="831" height="583" role="presentation" src="https://miro.medium.com/max/831/1*OKE6wyZFfh2f_aZ3rd9BRw.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1662/1*OKE6wyZFfh2f_aZ3rd9BRw.png" width="831" height="583" role="presentation"/></noscript></div></div></div></div><figcaption class="ba ds nz oa he cu x y ob oc av dr" data-selectable-paragraph="">Sample from inspect_balloon_data notebook</figcaption></figure><blockquote class="lo lp lq"><p id="db09" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>To create this notebook I copied <a href="https://github.com/matterport/Mask_RCNN/blob/master/samples/coco/inspect_data.ipynb" class="dg ca lk ll lm ln" target="_blank">inspect_data.ipynb</a>, which we wrote for the COCO dataset, and modified one block of code at the top to load the Balloons dataset instead.</p></blockquote><h1 id="da5a" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Configurations</h1><p id="e824" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">The configurations for this project are similar to the base configuration used to train the COCO dataset, so I just needed to override 3 values. As I did with the <code class="nk pk pl pm b">Dataset</code> class, I inherit from the base <code class="nk pk pl pm b">Config</code> class and add my overrides:</p><pre class="mm mn mo mp mq hc fd cm"><span id="b1b8" class="of lu do aw pm b ds pn po l pp" data-selectable-paragraph="">class BalloonConfig(Config):</span><span id="df09" class="of lu do aw pm b ds pq pr ps pt pu po l pp" data-selectable-paragraph="">    # Give the configuration a recognizable name<br>    NAME = "balloons"</span><span id="569d" class="of lu do aw pm b ds pq pr ps pt pu po l pp" data-selectable-paragraph="">    # Number of classes (including background)<br>    NUM_CLASSES = 1 + 1  # Background + balloon</span><span id="db8c" class="of lu do aw pm b ds pq pr ps pt pu po l pp" data-selectable-paragraph="">    # Number of training steps per epoch<br>    STEPS_PER_EPOCH = 100</span></pre><p id="004b" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">The base configuration uses input images of size 1024x1024 px for best accuracy. I kept it that way. My images are a bit smaller, but the model resizes them automatically.</p><blockquote class="lo lp lq"><p id="b92d" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>The base Config class is in <a href="https://github.com/matterport/Mask_RCNN/blob/master/mrcnn/config.py" class="dg ca lk ll lm ln" target="_blank">config.py</a>. And BalloonConfig is in<a href="https://github.com/matterport/Mask_RCNN/blob/v2.1/samples/balloon/balloon.py#L61" class="dg ca lk ll lm ln" target="_blank"> balloons.py</a>.</p></blockquote><h1 id="1f2b" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Training</h1><p id="0a7c" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">Mask R-CNN is a fairly large model. Especially that our implementation uses ResNet101 and FPN. So you need a modern GPU with 12GB of memory. It might work on less, but I haven’t tried. I used <a href="https://aws.amazon.com/ec2/instance-types/p2/" class="dg ca lk ll lm ln" target="_blank">Amazon’s P2 instances</a> to train this model, and given the small dataset, training takes less than an hour.</p><p id="7837" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">Start the training with this command, running from the <code class="nk pk pl pm b">balloon</code> directory. Here, we’re specifying that training should start from the pre-trained COCO weights. The code will download the weights from our repository automatically:</p><pre class="mm mn mo mp mq hc fd cm"><span id="c106" class="of lu do aw pm b ds pn po l pp" data-selectable-paragraph="">python3 balloon.py train --dataset=/path/to/dataset <strong class="pm ls">--model=coco</strong></span></pre><p id="fc26" class="kw kx do aw ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph="">And to resume training if it stopped:</p><pre class="mm mn mo mp mq hc fd cm"><span id="b555" class="of lu do aw pm b ds pn po l pp" data-selectable-paragraph="">python3 balloon.py train --dataset=/path/to/dataset <strong class="pm ls">--model=last</strong></span></pre><blockquote class="lo lp lq"><p id="d71e" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:<br></strong>In addition to balloons.py, the repository has three more examples: <a href="https://github.com/matterport/Mask_RCNN/blob/master/samples/shapes/train_shapes.ipynb" class="dg ca lk ll lm ln" target="_blank">train_shapes.ipynb</a> which trains a toy model to detect geometric shapes, <a href="https://github.com/matterport/Mask_RCNN/blob/master/samples/coco/coco.py" class="dg ca lk ll lm ln" target="_blank">coco.py</a> which trains on the COCO dataset, and <a href="https://github.com/matterport/Mask_RCNN/tree/master/samples/nucleus" class="dg ca lk ll lm ln" target="_blank">nucleus</a> which segments nuclei in microscopy images.</p></blockquote><h1 id="6bcb" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Inspecting the Results</h1><p id="a77c" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">The <a href="https://github.com/matterport/Mask_RCNN/blob/v2.1/samples/balloon/inspect_balloon_model.ipynb" class="dg ca lk ll lm ln" target="_blank">inspect_balloon_model</a> notebook shows the results generated by the trained model. Check the notebook for more visualizations and a step by step walk through the detection pipeline.</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y px"><div class="nj l ed nk"><div class="py l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*BvqnziHW514YyO20UNtS3g.png?q=20" width="812" height="347" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="812" height="347" role="presentation" src="https://miro.medium.com/max/812/1*BvqnziHW514YyO20UNtS3g.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1624/1*BvqnziHW514YyO20UNtS3g.png" width="812" height="347" role="presentation"/></noscript></div></div></div></div></figure><blockquote class="lo lp lq"><p id="29f6" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>This notebook is a simplified version of <a href="https://github.com/matterport/Mask_RCNN/blob/master/samples/coco/inspect_model.ipynb" class="dg ca lk ll lm ln" target="_blank">inspect_mode.ipynb</a>, which includes visualizations and debugging code for the COCO dataset.</p></blockquote><h1 id="1b36" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Color Splash</h1><p id="5e81" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj" data-selectable-paragraph="">Finally, now that we have object masks, let’s use them to apply the color splash effect. The method is really simple: create a grayscale version of the image, and then, in areas marked by the object mask, copy back the color pixels from original image. Here is an example:</p><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y pz"><div class="nj l ed nk"><div class="qa l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*iPAtWFnShPhX5atbY3V0pQ.png?q=20" width="942" height="494" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="942" height="494" role="presentation" src="https://miro.medium.com/max/942/1*iPAtWFnShPhX5atbY3V0pQ.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1884/1*iPAtWFnShPhX5atbY3V0pQ.png" width="942" height="494" role="presentation"/></noscript></div></div></div></div></figure><blockquote class="lo lp lq"><p id="5917" class="kw kx do lr ky b kz la lb lc ld le lf lg lh li lj" data-selectable-paragraph=""><strong class="ky ls">Code Tip:</strong><br>The code that applies the effect is in the <a href="https://github.com/matterport/Mask_RCNN/blob/v2.1/samples/balloon/balloon.py#L201" class="dg ca lk ll lm ln" target="_blank">color_splash()</a> function. And <a href="https://github.com/matterport/Mask_RCNN/blob/v2.1/samples/balloon/balloon.py#L221" class="dg ca lk ll lm ln" target="_blank">detect_and_color_splash()</a> handles the whole process from loading the image, running instance segmentation, and applying the color splash filter.</p></blockquote><h1 id="999f" class="lt lu do aw av dm lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">FAQ</h1><ul class=""><li id="3c51" class="kw kx do aw ky b kz mg lb mh ld mi lf mj lh mk lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Q:</strong> I want to dive deeper and understand the details, what should I read?<br><strong class="ky ls">A:</strong> Read these papers in this order: <a href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=AF8817DD0F70B32AA08B2ECBBA8099FA?doi=10.1.1.715.2453&amp;rep=rep1&amp;type=pdf" class="dg ca lk ll lm ln" target="_blank">RCNN (pdf)</a>, <a href="https://arxiv.org/abs/1504.08083" class="dg ca lk ll lm ln" target="_blank">Fast RCNN</a>, <a href="https://arxiv.org/abs/1506.01497" class="dg ca lk ll lm ln" target="_blank">Faster RCNN</a>, <a href="https://arxiv.org/abs/1612.03144" class="dg ca lk ll lm ln" target="_blank">FPN</a>, <a href="https://arxiv.org/abs/1703.06870" class="dg ca lk ll lm ln" target="_blank">Mask RCNN</a>.</li><li id="7e3a" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Q:</strong> Where can I ask more questions?<br><strong class="ky ls">A:</strong> The <a href="https://github.com/matterport/Mask_RCNN/issues" class="dg ca lk ll lm ln" target="_blank">Issues page on GitHub</a> is active, you can use it for questions, as well as to report issues. Remember to search closed issues as well in case your question has been answered already.</li><li id="fb26" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Q:</strong> Can I contribute to this project?<br><strong class="ky ls">A:</strong> That would be great. Pull Requests are always welcome.</li><li id="dec0" class="kw kx do aw ky b kz ns lb nt ld nu lf nv lh nw lj np nq nr" data-selectable-paragraph=""><strong class="ky ls">Q:</strong> Can I join your team and work on fun projects like this one?<br><strong class="ky ls">A:</strong> Yes, we’re hiring for deep learning and computer vision. <a href="https://matterport.com/careers/" class="dg ca lk ll lm ln" target="_blank">Apply here</a>.</li></ul><figure class="mm mn mo mp mq ep x y paragraph-image"><div class="nd ne ed nf ab"><div class="x y qb"><div class="nj l ed nk"><div class="qc l"><div class="cw ng gd n o gc ab cf nh ni"><img alt="" class="gd n o gc ab nm nn qg qh" src="https://miro.medium.com/max/60/1*w_ownWZZ38QhiVjVU757DA.png?q=20" width="937" height="621" role="presentation"></div><img alt="" class="qe qf gd n o gc ab ga" width="937" height="621" role="presentation" src="https://miro.medium.com/max/937/1*w_ownWZZ38QhiVjVU757DA.png"><noscript><img alt="" class="gd n o gc ab" src="https://miro.medium.com/max/1874/1*w_ownWZZ38QhiVjVU757DA.png" width="937" height="621" role="presentation"/></noscript></div></div></div></div></figure></div></section></div></article><div class="qe tx cy m cz da db dc dd e" data-test-id="post-sidebar"><div class="af cv"><div class="de df l"><a href="https://engineering.matterport.com/?source=post_sidebar--------------------------post_sidebar-" class="dg dh be bf bg bh bi bj bk bl di dj bo bp dk dl"><h2 class="av dm dn ax do">Matterport Engineering Techblog</h2></a><div class="dp dq l"><h4 class="av dr ds ax cf dt du dv dw dx ba">Thoughts on 3D from Matterport’s web and vision teams.</h4></div><div class="bz"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fengineering.matterport.com%2Fsplash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46&amp;source=post_sidebar--------------------------follow_sidebar-" class="dy bt bc bd bu bm bn bv bl bw av b aw ax ay az bx by ae bz ca bo">Follow</a></div></div><div class="dz ea eb af"><div class="af ag"><div class="ec l ed"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fengineering.matterport.com%2Fsplash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46&amp;source=post_sidebar-----7c761e238b46---------------------clap_sidebar-" class="dg dh be bf bg bh bi bj bk bl di dj bo bp dk dl"><div class="bj ee ef eg eh ei ej ek bd el bn"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="em l"><div class="en"><h4 class="av dr ds ax ba"><button class="dg dh be bf bg bh bi bj bk bl di dj bo bp dk dl">5.1K </button></h4></div></div></div></div><div><div class="bz"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fengineering.matterport.com%2Fsplash-of-color-instance-segmentation-with-mask-r-cnn-and-tensorflow-7c761e238b46&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="dg dh be bf bg bh bi bj bk bl di dj bo bp dk dl"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div><div> </div></body>
